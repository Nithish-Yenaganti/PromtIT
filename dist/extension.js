(()=>{"use strict";var e={53(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.compilePrompt=function(e,t){const n=(0,i.normalizeWhitespace)(e),{lower:o,hasStackTrace:a,files:c,commands:l}=(0,i.extractSignals)(n),u=function(e,t,n){return"SECURITY"===e?"SECURITY_REVIEW":"BUGFIX"===e?"BUGFIX":t.includes("security")||t.includes("vuln")||t.includes("owasp")?"SECURITY_REVIEW":n||t.includes("bug")||t.includes("error")||t.includes("fails")?"BUGFIX":t.includes("refactor")||t.includes("cleanup")||t.includes("rename")?"REFACTOR":t.includes("optimize")||t.includes("slow")||t.includes("performance")||t.includes("latency")?"PERFORMANCE":t.includes("test")||t.includes("coverage")||t.includes("unit test")?"TESTS":t.includes("explain")||t.includes("how does")||t.includes("what is")?"EXPLAIN":"GENERAL"}(t.profile,o,a),{role:p,intentRules:d}=(0,r.templateFor)(t.profile,u),f=function(e,t){const n=[],r=/(python|javascript|typescript|java|c\+\+|c#|go|rust|php|ruby)/i.test(t),i=/(react|next\.js|fastapi|django|flask|spring|dotnet|node|express)/i.test(t);return r||n.push("Target language/runtime"),i||"BUGFIX"!==e&&"REFACTOR"!==e||n.push("Framework/app type (if applicable)"),"BUGFIX"===e&&(/repro|reproduce|steps/i.test(t)||n.push("Reproduction steps"),/expected|actual/i.test(t)||n.push("Expected vs actual behavior"),/log|trace|stack/i.test(t)||n.push("Logs/stack trace (if available)")),"SECURITY_REVIEW"===e&&(/threat|attack|risk/i.test(t)||n.push("Threat model / what to protect"),/auth|token|session|jwt/i.test(t)||n.push("Auth/session details (if relevant)")),n.slice(0,10)}(u,o);return function(e){const t=[];t.push("SYSTEM:"),t.push(e.role),t.push("Rules:");for(const n of e.rules)t.push(`- ${n}`);return t.push(""),t.push("TASK:"),t.push(e.task),(e.contextProvided.files.length||e.contextProvided.commands.length)&&(t.push(""),t.push("CONTEXT PROVIDED:"),e.contextProvided.files.length&&t.push(`- Files mentioned: ${e.contextProvided.files.join(", ")}`),e.contextProvided.commands.length&&t.push(`- Commands mentioned:\n  - ${e.contextProvided.commands.join("\n  - ")}`)),t.push(""),t.push("REQUIRED OUTPUT:"),e.requiredOutput.forEach((e,n)=>t.push(`${n+1}) ${e}`)),e.unresolved.length&&(t.push(""),t.push("UNRESOLVED (DO NOT GUESS):"),e.unresolved.forEach(e=>t.push(`- ${e}`))),t.join("\n")}({role:p,rules:d,task:n,contextProvided:{files:c,commands:l},requiredOutput:s(u),unresolved:f})};const r=n(755),i=n(729);function s(e){switch(e){case"BUGFIX":return["Root cause analysis (based only on provided info)","Fix plan (file-level steps)","Patch or code changes (diff-style if possible)","Tests to add/update","Risk + rollback notes"];case"SECURITY_REVIEW":return["Findings prioritized by severity (with reasoning)","Concrete fixes and safer alternatives","Any code/config changes needed (specific, minimal)","Verification steps (how to prove itâ€™s fixed)"];case"REFACTOR":return["Refactor plan (what/why)","Proposed code changes (minimal, behavior-preserving)","Any tests or checks to confirm no regression"];case"PERFORMANCE":return["Bottleneck hypothesis + how to validate","Optimization plan with measurable impact","Concrete code/query changes","How to benchmark/verify improvements"];case"TESTS":return["Test strategy (what to cover and why)","Concrete test cases","Test code snippets"];case"EXPLAIN":return["Clear explanation with examples","If relevant: pitfalls and best practices"];default:return["Structured answer","Concrete next steps"]}}},160(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILES=void 0,t.PROFILES=[{key:"SWE",label:"SWE (General coding)"},{key:"BUGFIX",label:"Bugfix (Debug & patch)"},{key:"SECURITY",label:"Security (Review & hardening)"}]},265(e,t,n){var r,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),o=0;o<n.length;o++)"default"!==n[o]&&i(t,e,n[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){const t=a.commands.registerCommand("promptCompiler.compile",async()=>{const e=a.window.activeTextEditor;if(!e)return;const t=a.workspace.getConfiguration("promptCompiler").get("profile")||"SWE",n=e.selection,r=e.document.getText(n),i=r?.trim()?r:e.document.lineAt(n.active.line).text;if(!i.trim())return;const s=(0,c.compilePrompt)(i,{profile:t});await e.edit(t=>{r?.trim()?t.replace(n,s):t.replace(e.document.lineAt(n.active.line).range,s)})}),n=a.commands.registerCommand("promptCompiler.setProfile",async()=>{const e=await a.window.showQuickPick(l.PROFILES.map(e=>({label:e.label,value:e.key})),{placeHolder:"Select Prompt Compiler profile"});e&&(await a.workspace.getConfiguration("promptCompiler").update("profile",e.value,a.ConfigurationTarget.Global),a.window.showInformationMessage(`Prompt Compiler profile set to: ${e.value}`))});e.subscriptions.push(t,n)},t.deactivate=function(){};const a=o(n(398)),c=n(53),l=n(160)},398(e){e.exports=require("vscode")},729(e,t){function n(e){return[...new Set(e)].slice(0,20)}Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeWhitespace=function(e){return e.replace(/\r\n/g,"\n").replace(/[ \t]+\n/g,"\n").replace(/\n{3,}/g,"\n\n").trim()},t.extractSignals=function(e){const t=e.toLowerCase(),r=/exception|stack trace|traceback|at\s+\w+\./i.test(e)||/traceback \(most recent call last\)/i.test(e),i=Array.from(e.matchAll(/(?:^|\s)([\w./-]+\.\w{1,6})(?=\s|$)/g)).map(e=>e[1]),s=Array.from(e.matchAll(/(?:^|\n)\s*(npm|pnpm|yarn|pytest|python|node|go|mvn|gradle)\b[^\n]*/g)).map(e=>e[0].trim());return{lower:t,hasStackTrace:r,files:n(i),commands:n(s)}}},755(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.templateFor=function(e,t){const n="SECURITY"===e?"You are a senior application security engineer.":"BUGFIX"===e?"You are a senior software engineer specializing in debugging and safe fixes.":"You are a senior software engineer focused on correct, minimal changes.",r=function(e){return["Do not assume missing details. If something is not provided, list it under UNRESOLVED (DO NOT GUESS).","Keep scope minimal. Touch only what is necessary.","Be explicit and structured. Prefer steps and concrete outputs.",...{BUGFIX:["Explain likely root cause(s) before proposing changes.","Provide a patch plan and tests to prevent regressions."],SECURITY_REVIEW:["Focus on real attack paths, not generic advice.","Prioritize issues by severity and exploitability.","Provide concrete fixes and safer alternatives."],REFACTOR:["Do not change external behavior unless explicitly requested.","Explain refactor intent and show before/after where relevant."],PERFORMANCE:["Identify the bottleneck hypothesis and how to validate it.","Propose measurable improvements and verification steps."],TESTS:["Propose tests that fail before the fix and pass after.","Prefer minimal, high-signal test cases."],EXPLAIN:["Explain clearly with examples.","Use short sections and avoid rambling."],GENERAL:[]}[e]]}(t);return{role:n,intentRules:r}}}},t={},n=function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}(265);module.exports=n})();